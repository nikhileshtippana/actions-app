name: Sync Ops
run-name: ${{ github.event.ref }} branch on ${{ github.event_name }}

on:
  create: {}
  delete: {}
  push:
    branches:
      - 'main'
      - 'dev/**'
    paths:
      - 'src/**'
      - '.github/workflows/sync_ops.yml'

jobs:
  sync:
    if: ${{ contains(fromJSON('["create", "push"]'), github.event_name) && ( github.ref == 'refs/heads/main' || startsWith(github.ref, 'refs/heads/dev/') ) }}
    runs-on: ubuntu-latest

    steps:
      - run: echo "Sync ${{ github.ref }}"

  cleanup:
    if: ${{ github.event_name == 'delete' && startsWith(github.event.ref, 'dev/') }}
    runs-on: ubuntu-latest

    steps:
      - run: echo "Cleanup ${{ github.event.ref }}"